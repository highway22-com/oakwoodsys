<!-- Hero Section (contenido desde resources-content.json) -->
<app-video-hero
  [loading]="false"
  [hvh70]="true"
  [videoUrls]="videoHeroContent().videoUrls"
  [title]="videoHeroContent().title"
  [description]="videoHeroContent().description"
  [ctaPrimary]="videoHeroContent().ctaPrimary"
  [ctaSecondary]="videoHeroContent().ctaSecondary"
  [showIndicators]="false"
/>

<!-- Featured Case Study Section -->
<div class="w-full lg:bg-p-10 p-2 sm:p-10">
  @if (featuredCaseStudy(); as featured) {
    <app-featured-case-study-cards
      [slugsFeaturedCaseStudies]="getSlugsForFeaturedSection()"
    />
  }
</div>

<!-- Filter Tabs and Search Section -->
<section class="w-full bg-white py-6 sm:py-8" aria-label="Filter and Search">
  <div class="px-4 sm:px-6 md:px-8 lg:px-24">
    <div
      class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 sm:gap-6"
    >
      <!-- Filter Tabs: Mobile Dropdown & Desktop Buttons -->
      <!-- Mobile: Dropdown -->
      <!-- Mobile: Dropdown -->
      <div class="w-full block sm:hidden">
        <div class="relative">
          <button
            (click)="toggleDropdown()"
            class="w-full flex items-center justify-between border border-gray-300 rounded-lg px-4 py-3 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-p-700"
          >
            <span
              class="flex items-center font-inter font-medium text-[16px] leading-[100%] tracking-normal text-[#3D3D3D] gap-2"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M0 1.6875C0 0.773438 0.738281 0 1.6875 0H5.0625C5.97656 0 6.75 0.773438 6.75 1.6875V5.0625C6.75 6.01172 5.97656 6.75 5.0625 6.75H1.6875C0.738281 6.75 0 6.01172 0 5.0625V1.6875ZM1.6875 5.0625H5.0625V1.6875H1.6875V5.0625ZM0 10.6875C0 9.77344 0.738281 9 1.6875 9H5.0625C5.97656 9 6.75 9.77344 6.75 10.6875V14.0625C6.75 15.0117 5.97656 15.75 5.0625 15.75H1.6875C0.738281 15.75 0 15.0117 0 14.0625V10.6875ZM1.6875 14.0625H5.0625V10.6875H1.6875V14.0625ZM14.0625 0C14.9766 0 15.75 0.773438 15.75 1.6875V5.0625C15.75 6.01172 14.9766 6.75 14.0625 6.75H10.6875C9.73828 6.75 9 6.01172 9 5.0625V1.6875C9 0.773438 9.73828 0 10.6875 0H14.0625ZM14.0625 1.6875H10.6875V5.0625H14.0625V1.6875ZM9 10.6875C9 9.77344 9.73828 9 10.6875 9H14.0625C14.9766 9 15.75 9.77344 15.75 10.6875V14.0625C15.75 15.0117 14.9766 15.75 14.0625 15.75H10.6875C9.73828 15.75 9 15.0117 9 14.0625V10.6875ZM10.6875 14.0625H14.0625V10.6875H10.6875V14.0625Z"
                  fill="#0D53A2"
                />
              </svg>

              {{ getSelectedFilterDisplayName() }}
            </span>
            <!-- Arrow Icon -->
            <svg
              class="w-5 h-5 transition-transform duration-200"
              [ngClass]="{ 'rotate-180': isOpen }"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"
              />
            </svg>
          </button>
          <!-- Dropdown Menu -->
          <div
            *ngIf="isOpen"
            class="mt-2 bg-white border border-gray-200 rounded-lg shadow-md max-h-44 overflow-y-auto z-10 absolute w-full left-0"
          >
            @for (filter of filters; track filter.value) {
              <button
                (click)="
                  selectFilter(filter.value);
                  $event.preventDefault();
                  $event.stopPropagation()
                "
                [ngClass]="
                  selectedFilter() === filter.value ? 'bg-[#F2F8FD]' : ''
                "
                class="w-full text-left px-4 py-3 hover:bg-gray-100 relative"
              >
                <span
                  class="flex items-center font-sans font-medium text-[16px] leading-[1] tracking-normal text-[#454545] gap-2"
                >
                  {{ filter.displayCategory }}
                </span>
                <span
                  *ngIf="selectedFilter() === filter.value"
                  class="absolute right-4 top-1/2 -translate-y-1/2"
                >
                  <svg
                    width="15"
                    height="10"
                    viewBox="0 0 15 10"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M13.8438 0.28125C14.1562 0.59375 14.1562 1.0625 13.8438 1.34375L5.59375 9.59375C5.3125 9.90625 4.84375 9.90625 4.5625 9.59375L0.3125 5.34375C0 5.0625 0 4.59375 0.3125 4.28125C0.59375 4 1.0625 4 1.34375 4.28125L5.09375 8.03125L12.8125 0.28125C13.0938 0 13.5625 0 13.8438 0.28125Z"
                      fill="#2A7EBF"
                    />
                  </svg>
                </span>
              </button>
            }
          </div>
        </div>
      </div>
      <!-- Desktop: Buttons -->
      <div
        class="hidden sm:flex flex-wrap items-center gap-2 sm:gap-3 overflow-x-auto scrollbar-hide pb-2"
      >
        @for (filter of filters; track filter.value) {
          @let isSelected = selectedFilter() === filter.value;
          <button
            (click)="selectFilter(filter.value)"
            [class.bg-p-700]="isSelected"
            [class.text-white]="isSelected"
            [ngClass]="{ 'button-filter': !isSelected }"
            class="px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base transition-all duration-200 hover:opacity-90 whitespace-nowrap"
          >
            {{ filter.displayCategory }}
          </button>
        }
      </div>

      <!-- Search -->
      <div class="relative w-full sm:w-auto min-w-[200px] sm:min-w-[300px]">
        <div
          class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <svg
            class="w-5 h-5 text-gray-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            />
          </svg>
        </div>
        <input
          type="text"
          [placeholder]="searchPlaceholder()"
          [value]="searchQuery()"
          (input)="onSearchChange($any($event.target).value)"
          class="block w-full pl-10 pr-3 py-2 sm:py-3 border border-gray-300 focus:ring-2 focus:ring-p-700 focus:border-p-700 text-sm sm:text-base"
        />
      </div>
    </div>
  </div>
</section>

<!-- Resources Grid Section -->
<section class="w-full bg-white py-12 sm:py-16 md:py-20" aria-label="Resources">
  <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-12">
    @if (filteredResources().length === 0) {
      <div class="text-center py-12">
        <p class="text-lg text-gray-600">{{ emptyStateMessage() }}</p>
      </div>
    } @else {
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 sm:gap-10 md:gap-12">
        @for (card of filteredResources(); track card.id) {
          <app-blog-card
            [slug]="card.slug"
            [imageUrl]="card.image"
            [imageAlt]="card.title"
            [tag]="card.primaryTag ?? card.category"
            [readingTimeMinutes]="3"
            [title]="card.title"
            [excerptHtml]="getSanitizedExcerpt(card.description)"
            [authorDisplayName]="null"
            [date]="card.date"
            linkBase="/resources/case-studies"
          />
        }
      </div>
    }
  </div>
</section>

<!-- CTA Section (contenido desde resources-content.json) -->
<app-cta-section
  [title]="ctaSectionContent().title"
  [description]="ctaSectionContent().description"
  [primaryText]="ctaSectionContent().ctaPrimary.text ?? ''"
  [primaryLink]="ctaSectionContent().ctaPrimary.link ?? ''"
  [secondaryText]="ctaSectionContent().ctaSecondary.text ?? ''"
  [secondaryLink]="ctaSectionContent().ctaSecondary.link ?? ''"
/>
