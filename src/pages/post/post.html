@if (post(); as p) {
<!-- Post Content (datos cargados) -->
<article class="min-h-screen ">
  <!-- Hero Section -->
  <section
    class="relative w-full min-h-[82vh] bg-gradient-to-br from-blue-900 via-blue-800 to-slate-900 flex items-center">
    @if (p.featuredImage?.node?.sourceUrl) {
    <img [src]="p.featuredImage!.node!.sourceUrl" [alt]="p.featuredImage!.node!.altText || p.title"
      class="absolute inset-0 w-full h-full object-cover" />
    }
    <div class="absolute inset-0 bg-slate-900/70"></div>

    <div class="relative z-10 px-4 sm:px-6 md:px-8 lg:px-28 py-16 sm:py-20 self-end">
      <div class="max-w-4xl ">
        <nav class="mb-6" aria-label="Breadcrumb">
          <ol class="flex items-center space-x-2 text-sm text-white/80">
            @for (crumb of getBreadcrumbs(); track crumb.label + (crumb.link ?? ''); let last = $last) {
            @if (!last) {
            <li class="font-segoe">
              @if (crumb.link) {
              <a [routerLink]="crumb.link" class="hover:text-white transition-colors">{{ crumb.label }}</a>
              } @else {
              <span>{{ crumb.label }}</span>
              }
            </li>
            <li><span class="mx-2">/</span></li>
            } @else {
            <li class="text-white">{{ crumb.label }}</li>
            }
            }
          </ol>
        </nav>

        <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-[4rem] text-white leading-tight">
          {{ p.title }}
        </h1>

        <div class="flex flex-col py-6">
          <div class="flex flex-col sm:flex-row flex-wrap items-center gap-4 sm:gap-6 text-white/90">
            @if (p.authorPerson || p.author.node) {
            <div class="flex items-center gap-3 ">
              <div class="tag-badge-transparent">
                {{ p.primaryTag }}
              </div>
              @if (p.author.node.firstName === 'Oakwood') {
              <img src="/assets/oawPerson.png" [alt]="authorDisplayName(p)"
                class="w-10 h-10      object-cover flex-shrink-0" />
              }
              @else if (p.authorPerson?.picture) {
              <img [src]="p.authorPerson!.picture!" [alt]="authorDisplayName(p)"
                class="w-10 h-10      object-cover flex-shrink-0" />
              } @else {
              <div class="w-10 h-10 bg-white/20      flex items-center justify-center">
                <span class="text-white      ">
                  {{ (p.authorPerson?.name || p.authorPerson?.firstName || p.author.node.firstName || 'A').charAt(0) }}
                </span>
              </div>
              }
              <div class="flex flex-col">
                <p class="text-sm       ">{{ authorDisplayName(p) }}</p>
                @if (p.date) {
                <div class="flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  <span class="text-sm">{{ p.date | date:'d MMM, yyyy' }}</span>
                  <span class="mx-0.5">•</span>
                  <span class="text-sm ">{{ readingTimeMinutes(p.content) }} min read</span>
                </div>
                }
              </div>
            </div>
            }

          </div>
          <div class="py-6">
            <div class="flex items-center gap-3 ml-auto">
              <label for="share" class="text-sm text-white/80">Share</label>
              <a href="#"
                class="w-8 h-8 flex items-center justify-center text-white/80 hover:text-white transition-colors"
                aria-label="Share on Facebook">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                </svg>
              </a>
              <a href="#"
                class="w-8 h-8 flex items-center justify-center text-white/80 hover:text-white transition-colors"
                aria-label="Share on Twitter">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
                </svg>
              </a>
              <a href="#"
                class="w-8 h-8 flex items-center justify-center text-white/80 hover:text-white transition-colors"
                aria-label="Share on LinkedIn">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
                </svg>
              </a>
            </div>
          </div>
          <!-- Social Share Icons -->
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content Section -->
  <section class="w-full py-12 sm:py-16 md:py-20 lg:py-24 bg-white">
    <div class="px-4 sm:px-6 md:px-8 lg:px-1">
      <div class="px-28">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12">
          <!-- Left Column: Table of Contents (siempre visible) -->
          <aside class="lg:col-span-3 pl-12">
            <div class="sticky top-24">
              <h2 class="text-lg font-semibold uppercase tracking-wider text-gray-700/60 mb-4">Table of Contents</h2>
              <nav class="space-y-2">
                @for (item of tableOfContents(); track item.id) {
                <a (click)="scrollToSection(item.id)"
                  [class]="activeSection() === item.id
                     ? 'block px-3 py-2 text-[1.06rem] text-p-500 bg-p-30 font-semibold transition-colors cursor-pointer'
                     : 'block px-3 py-2 text-[1.06rem] text-gray-700 hover:text-p-500 hover:bg-p-30 transition-colors cursor-pointer'">
                  {{ item.text }}
                </a>
                } @empty {
                <p class="text-sm text-gray-500 px-3 py-2">No sections in this post.</p>
                }
              </nav>
            </div>
          </aside>

          <!-- Right Column: Blog Content -->
          <div class="lg:col-span-9">
            <!-- Excerpt -->
            <!-- @if (post()!.sanitizedExcerpt) {
            <div class="mb-8 sm:mb-12 p-6 bg-blue-50 border-l-4 border-p-700 rounded-r-lg prose prose-sm max-w-none"
              [innerHTML]="post()!.sanitizedExcerpt">
            </div>
            } @else if (post()!.excerpt) {
            <div class="mb-8 sm:mb-12 p-6 bg-blue-50 border-l-4 border-blue-600 rounded-r-lg">
              <p class="text-lg sm:text-xl text-gray-700 leading-relaxed       ">
                {{ post()!.excerpt }}
              </p>
            </div>
            } -->

            <!-- Main Content -->
            @if (p.sanitizedContent) {
            <div class="html-content" [innerHTML]="p.sanitizedContent"></div>
            }

            <!-- Author Card -->
            <!-- @if (post()!.authorPerson || post()!.author.node) {
            <div class="mt-12 sm:mt-16 pt-8 sm:pt-12 border-t border-gray-200">
              <div class="flex items-start gap-4 sm:gap-6">
                @if (post()!.authorPerson?.picture) {
                <img [src]="post()!.authorPerson!.picture!" [alt]="authorDisplayName(post()!)"
                  class="w-16 h-16 sm:w-20 sm:h-20      object-cover flex-shrink-0" />
                } @else {
                <div class="w-16 h-16 sm:w-20 sm:h-20 bg-blue-100      flex items-center justify-center flex-shrink-0">
                  <span class="text-blue-600 font-bold text-xl sm:text-2xl">
                    {{ (post()!.authorPerson?.name || post()!.authorPerson?.firstName || post()!.author.node.firstName
                    || 'A').charAt(0) }}
                  </span>
                </div>
                }
                <div>
                  <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-2">
                    {{ authorDisplayName(post()!) }}
                  </h3>
                  @if (post()!.author.node.email) {
                  <p class="text-sm text-gray-600 mb-2">{{ post()!.author.node.email }}</p>
                  }
                  @if (post()!.authorPerson?.position) {
                  <p class="text-sm text-gray-600 mb-2">{{ post()!.authorPerson?.position }}</p>
                  }
                  <p class="text-sm text-gray-600">
                    Published on {{ post()!.date | date:'MMMM d, y' }}
                  </p>
                </div>
              </div>
            </div>
            } -->

            <!-- Navigation -->
            <!-- <div class="mt-12 sm:mt-16 pt-8 sm:pt-12 border-t border-gray-200">
              <a routerLink="/blog"
                class="inline-flex items-center text-blue-600 hover:text-blue-700        transition-colors duration-200">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Back to All Posts
              </a>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Form Section (oculta si Gen Content tiene showContactSection = false) -->
  @if (p.showContactSection !== false) {
  <section class="w-full py-16 sm:py-20 md:py-24 bg-gradient-to-r from-purple-50 via-blue-50 to-blue-100">
    <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-12">
      <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
          <!-- Left Column: Image -->
          <div class="relative w-full h-full    overflow-hidden">
            <img src="https://oakwoodsys.com/wp-content/uploads/2026/02/contactus.png" alt="Team collaboration"
              class="w-full h-full object-cover" />
          </div>


          <!-- Right Column: Form -->
          <div class="order-1 lg:order-2">
            <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold text-gray-900 mb-4 sm:mb-6">
              Let's bring your Ideas to life
            </h2>
            <p class="text-base sm:text-lg text-gray-700 mb-8 sm:mb-10 leading-relaxed">
              Get in touch with our team to discuss how we can help transform your business with innovative solutions.
            </p>
            <form class="space-y-6">
              <div>
                <label for="email" class="block text-sm        text-gray-700 mb-2">Your email address</label>
                <input type="email" id="email" name="email"
                  class="w-full px-4 py-3 border border-gray-300    focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none transition-colors"
                  placeholder="your.email@example.com" />
              </div>
              <div>
                <label for="company" class="block text-sm        text-gray-700 mb-2">Your company name</label>
                <input type="text" id="company" name="company"
                  class="w-full px-4 py-3 border border-gray-300    focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none transition-colors"
                  placeholder="Company Name" />
              </div>
              <div>
                <label for="message" class="block text-sm        text-gray-700 mb-2">Your message</label>
                <textarea id="message" name="message" rows="4"
                  class="w-full px-4 py-3 border border-gray-300    focus:ring-2 focus:ring-blue-600 focus:border-blue-600 outline-none transition-colors resize-none"
                  placeholder="Tell us about your project..."></textarea>
              </div>
              <div class="flex items-start">
                <input type="checkbox" id="agree" name="agree"
                  class="mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-600" />
                <label for="agree" class="ml-3 text-sm text-gray-700">
                  I agree to receive communications from Oakwood.
                </label>
              </div>
              <button type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white       px-6 py-3    transition-colors duration-200">
                Send Message
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  }
  <!-- Related case studies -->
  @if (p.relatedBloqs && p.relatedBloqs.length > 0) {
  <section id="related-resources" class="w-full bg-white py-12 sm:py-16 md:py-20"
    aria-labelledby="related-case-studies">
    <div class="container mx-auto px-4 sm:px-6 md:px-8 lg:px-12">
      <div class="max-w-7xl mx-auto">
        <h2 id="related-case-studies" class="text-3xl sm:text-4xl md:text-5xl  text-gray-900 mb-4 sm:mb-6">
          Related case studies
        </h2>
        <p class="text-base sm:text-lg text-gray-600 mb-8 sm:mb-10 max-w-3xl font-segoe">
          Our proven track record helps to redefine what's possible, enabling your workforce, ecosystem, and global
          operations.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 sm:gap-10">
          @for (related of p.relatedBloqs; track related.id) {
          <app-blog-card [slug]="related.slug" [imageUrl]="related.featuredImage?.node?.sourceUrl ?? ''"
            [imageAlt]="related.title ?? 'Blog post'" [tag]="related.primaryTag ?? null" [readingTimeMinutes]="3"
            [title]="related.title ?? ''" [excerptHtml]="related.sanitizedExcerpt ?? null" [authorDisplayName]="null"
            [date]="related.date ?? ''" />
          }
        </div>
      </div>
    </div>
  </section>
  }
</article>

} @else {
<!-- Placeholder mientras carga el post (data asíncrona) -->
<article class="min-h-screen" aria-busy="true" aria-label="Loading post">
  <!-- Hero skeleton -->
  <section
    class="relative w-full min-h-[82vh] bg-gradient-to-br from-blue-900 via-blue-800 to-slate-900 flex items-center">
    <div class="absolute inset-0 bg-slate-900/70"></div>
    <div class="relative z-10 px-4 sm:px-6 md:px-8 lg:px-28 py-16 sm:py-20 self-end w-full max-w-4xl">
      <nav class="mb-6 flex items-center gap-2">
        <span class="h-4 w-16 bg-white/30 rounded animate-pulse"></span>
        <span class="text-white/50">/</span>
        <span class="h-4 w-24 bg-white/30 rounded animate-pulse"></span>
        <span class="text-white/50">/</span>
        <span class="h-4 w-48 bg-white/40 rounded animate-pulse"></span>
      </nav>
      <div class="h-12 sm:h-14 w-full max-w-2xl bg-white/30 rounded animate-pulse mb-2"></div>
      <div class="h-12 sm:h-14 w-4/5 max-w-xl bg-white/25 rounded animate-pulse mb-6"></div>
      <div class="flex items-center gap-3">
        <span class="h-6 w-20 bg-white/30 rounded animate-pulse"></span>
        <span class="h-10 w-10 rounded-full bg-white/25 animate-pulse"></span>
        <div class="space-y-2">
          <span class="block h-3 w-24 bg-white/30 rounded animate-pulse"></span>
          <span class="block h-3 w-32 bg-white/25 rounded animate-pulse"></span>
        </div>
      </div>
    </div>
  </section>
  <!-- Content skeleton -->
  <section class="w-full py-12 sm:py-16 md:py-20 lg:py-24 bg-white">
    <div class="px-4 sm:px-6 md:px-8 lg:px-1">
      <div class="px-28">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12">
          <aside class="lg:col-span-3 pl-12">
            <div class="sticky top-24">
              <div class="h-5 w-36 bg-gray-200 rounded animate-pulse mb-4"></div>
              <nav class="space-y-2">
                @for (i of [1,2,3,4,5]; track i) {
                <div class="h-9 w-full bg-gray-100 rounded animate-pulse"></div>
                }
              </nav>
            </div>
          </aside>
          <div class="lg:col-span-9 space-y-4">
            <div class="h-4 w-full bg-gray-200 rounded animate-pulse"></div>
            <div class="h-4 w-full bg-gray-200 rounded animate-pulse"></div>
            <div class="h-4 w-5/6 bg-gray-200 rounded animate-pulse"></div>
            <div class="h-4 w-full bg-gray-100 rounded animate-pulse"></div>
            <div class="h-4 w-full bg-gray-100 rounded animate-pulse"></div>
            <div class="h-4 w-5/6 bg-gray-100 rounded animate-pulse"></div>
            <div class="h-4 w-full bg-gray-100 rounded animate-pulse pt-4"></div>
            <div class="h-4 w-full bg-gray-100 rounded animate-pulse"></div>
            <div class="h-4 w-3/4 bg-gray-100 rounded animate-pulse"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
</article>
}

<app-cta-section title="Let's move your vision forward"
  description="Connect with a team committed to helping you modernize, innovate, and achieve meaningful results."
  primaryText="Talk to an expert" primaryLink="/contact-us"  />